{"componentChunkName":"component---2377189310-rvice-mesh-istio-webassembly-and-intelligent-data-planes-mdx","path":"/learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/webassembly-and-intelligent-data-planes.html.html","result":{"data":{"chapter":{"body":"\n\n\nimport installimagehub from \"../../../../src/assets/images/learn-layer5/istio/install-imagehub.webp\";\nimport deployenvoyfilter from \"../../../../src/assets/images/learn-layer5/istio/deploy-envoyfilter.webp\";\n\n<ChapterStyle>\n\nIn this lab, you will use the sample application [Image Hub](https://github.com/layer5io/image-hub). This version of the Image Hub filter has been simplified for your lab. To self-study deeper functionality, try the other version of the Image Hub filter that is available in the Image Hub repo.\n\n<h2 className=\"chapter-sub-heading\">Deploy Sample Application</h2>\n\nUsing Meshery, select Istio from the Management menu.\n\nIn the Istio management page:\n\n1. Type default into the namespace field.\n2. Click the (+) icon on the Manage Sample Application Lifecycle card and select Image Hub Application to install the latest version of Image Hub\n\n\n<img src={installimagehub} align=\"center\" width=\"100%\" />\n\n<br />\n<br />\n\n<h2 className=\"chapter-sub-heading\">Load the filter</h2>\n\nNext, load the custom Envoy filter. This filter is written in Rust and is compiled against WebAssembly as it's target runtime.\n\nUsing Meshery, select Istio from the Management menu.\n\nIn the Istio management page:\n\n1. Type default into the namespace field.\n2. Click the (+) icon on the Apply Service Mesh Configuration card and select Envoy Filter for Image Hub to deploy the custom filter.\n\n<img src={deployenvoyfilter} align=\"center\" width=\"100%\" />\n\n<br />\n<br />\n<h2 className=\"chapter-sub-heading\">Send traffic</h2>\n<br />\n<h2 className=\"chapter-sub-heading\">Analyze behavior</h2>\n\nAlternative, manual installation steps are provided for reference below. No need to execute these if you have performed the steps above.\n\nManually deploy the Image Hub filter.\n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: EnvoyFilter\nmetadata:\n  name: custom-filter\nspec:\n  configPatches:\n    - applyTo: HTTP_FILTER\n      match:\n        context: SIDECAR_OUTBOUND # will match outbound listeners in all sidecars\n        listener:\n          portNumber: 9080\n          filterChain:\n            name: envoy.http_connection_manager\n            filter:\n              name: \"envoy.tcp_proxy\"\n      patch:\n        operation: INSERT_BEFORE\n        value:\n          # This is the full filter config including the name and config or typed_config section.\n          name: \"envoy.filters.http.wasm\"\n          config:\n            config:\n              name: custom-filter\n              rootId: my_root_id\n              vmConfig:\n                code:\n                  local:\n                    filename: /var/lib/imagehub/filter.wasm\n                runtime: envoy.wasm.runtime.v8\n                vmId: custom-filter\n                allow_precompiled: true\n  workloadSelector:\n    labels:\n      app: api-v1\n      version: v1\n\n```\nManually patch the Image Hub Deployment.\n\n```yaml\n---(\n  // kubectl patch deployment/api-v1 -p '\n  {\n    \"spec\": {\n      \"template\": {\n        \"metadata\": {\n          \"annotations\": {\n            \"sidecar.istio.io/userVolumeMount\": \"[{\\\"mountPath\\\":\\\"/var/lib/imagehub\\\",\\\"name\\\":\\\"wasm-filter\\\"}]\"\n          }\n        },\n        \"spec\": {\n          \"initContainers\": [\n            {\n              \"command\": [\n                \"curl\",\n                \"-L\",\n                \"-o\",\n                \"/var/lib/imagehub/filter.wasm\",\n                \"https://github.com/layer5io/advanced-istio-service-mesh-workshop/raw/master/lab-7/ratelimiter/ratelimit-filter.wasm\"\n              ],\n              \"image\": \"curlimages/curl\",\n              \"imagePullPolicy\": \"Always\",\n              \"name\": \"add-wasm\",\n              \"resources\": {},\n              \"terminationMessagePath\": \"/dev/termination-log\",\n              \"terminationMessagePolicy\": \"File\",\n              \"volumeMounts\": [\n                {\n                  \"mountPath\": \"/var/lib/imagehub\",\n                  \"name\": \"wasm-filter\"\n                }\n              ]\n            }\n          ],\n          \"volumes\": [\n            {\n              \"emptyDir\": {},\n              \"name\": \"wasm-filter\"\n            }\n          ]\n        }\n      }\n    }\n  }\n)\n// '\n\n```\nA future version of Meshery will allow you to deploy any filter from the [wasm-filters](https://github.com/layer5io/wasm-filters) repo. PR the repo to upload your custom filter and have Meshery deploy it.\n\n</ChapterStyle>\n","frontmatter":{"chapterTitle":"WebAssembly and intelligent data planes","description":"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads."},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/webassembly-and-intelligent-data-planes","course":"advance-concepts-of-service-mesh","learnpath":"mastering-service-meshes-for-developers","chapter":"webassembly-and-intelligent-data-planes"}},"course":{"nodes":[{"frontmatter":{"courseTitle":"Advance Concepts of Service Meshes - Hands On","meshesYouLearn":[{"imagepath":{"childImageSharp":null,"extension":"svg","publicURL":"/static/731763d720780a49c2ffdfede8c28f4b/istio.svg"},"name":"Istio"},{"imagepath":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/webp;base64,UklGRl4CAABXRUJQVlA4WAoAAAAQAAAAEwAAEgAAQUxQSCsBAAABkK1t27FFd7Zt2y3WBti2bdvWmrHU0Q7YNbbtybZdz+D7/m2IiAkAY8hqnoBA3moIOFSBTPv19+/X7TJQYSm67VOG5X16pafcd1sEQNydhzdp5yCXnytw+exwJ4mXx118lV7aQLbj+psDROvOlwNsX9Iq9cze9CrB+iEN6EBvmG5ne4jeXf3aOcjm5wpePqsWhdOPq3dER/kC8h/oqx3E6s8X/bkE8g+J4mF+j0YfU7829EfonjniiWKw8dMFos/ptEoELj83EPPfbhq8Fi6ami4WvJC2y8EveqQFwyc//4timb27dlohXDz7XyRbsUTzxfwkyxOmB5owmiCmp9wiDLcnZcJoYRDhBlAfjdmmZzTnWTyL6Hqwz+7S1CTtzYJjz8eeXFyej72YAABWUDggDAEAANAGAJ0BKhQAEwA+0VykTqglIyIoCqkAGglsALsyhHtYgrcJsK8xLFfoAdLcXseXeC9VGgsgkUpjlH7xR/xXEADeLYf7CYczoIv9t/vBQKOfOllI+unz6A0lUpkyuYCaKrQ3V/cH/zwEMeMfwM3TEUaJUejIEnllgZV0KT+dRXgVwdljiM/5bOUho/K6UAbp3tBPzBB385WEFco7bcPG7AiNcgse0VFkQn/VypGu+AnTdSJIx1S2ryZdD/2XLOJ/2cfL0Hca9wb71w7I4H9Yu5BrsoDN2sW9vnwGPwP0y+vhwJpyyj8G2UOOH3E7diegyWWXc0Z6zTp5+P+Tfv1AmHIlVCYdE2okyAD9gAA="},"images":{"fallback":{"src":"/static/ca53815f6e4054379084f39f253f9a9d/2bba5/linkerd.webp","srcSet":"/static/ca53815f6e4054379084f39f253f9a9d/02e18/linkerd.webp 13w,\n/static/ca53815f6e4054379084f39f253f9a9d/04db5/linkerd.webp 25w,\n/static/ca53815f6e4054379084f39f253f9a9d/2bba5/linkerd.webp 50w,\n/static/ca53815f6e4054379084f39f253f9a9d/2d116/linkerd.webp 100w","sizes":"(min-width: 50px) 50px, 100vw"},"sources":[]},"width":50,"height":47}},"extension":"webp","publicURL":"/static/ca53815f6e4054379084f39f253f9a9d/linkerd.webp"},"name":"Linkerd"}]},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh"}}]},"TOC":{"nodes":[{"frontmatter":{"order":8,"chapterTitle":"Conclusion"},"fields":{"section":"istio","chapter":"conclusion"}},{"frontmatter":{"order":2,"chapterTitle":"Deploy a sample application"},"fields":{"section":"istio","chapter":"deploy-an-application"}},{"frontmatter":{"order":3,"chapterTitle":"Exposing services through Istio Ingress Gateway"},"fields":{"section":"istio","chapter":"expose-services"}},{"frontmatter":{"order":1,"chapterTitle":"Getting Started"},"fields":{"section":"istio","chapter":"getting-started"}},{"frontmatter":{"order":4,"chapterTitle":"Observability"},"fields":{"section":"istio","chapter":"observability"}},{"frontmatter":{"order":6,"chapterTitle":"Service security capabilities"},"fields":{"section":"istio","chapter":"service-security-capabilities"}},{"frontmatter":{"order":5,"chapterTitle":"Traffic management"},"fields":{"section":"istio","chapter":"traffic-management"}},{"frontmatter":{"order":7,"chapterTitle":"WebAssembly and intelligent data planes"},"fields":{"section":"istio","chapter":"webassembly-and-intelligent-data-planes"}}]},"serviceMeshesList":{"nodes":[{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}}]}},"pageContext":{"learnpath":"mastering-service-meshes-for-developers","slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/webassembly-and-intelligent-data-planes","course":"advance-concepts-of-service-mesh","section":"istio","chapter":"webassembly-and-intelligent-data-planes","pageType":"chapter","frontmatter":{"docType":"Chapter","chapterTitle":"WebAssembly and intelligent data planes","description":"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads.","videos":4,"lectures":12,"order":7}}},"staticQueryHashes":["1376321266","1485533831","2848499768","4047814605","961506260"],"matchPath":"/learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/webassembly-and-intelligent-data-planes.html"}