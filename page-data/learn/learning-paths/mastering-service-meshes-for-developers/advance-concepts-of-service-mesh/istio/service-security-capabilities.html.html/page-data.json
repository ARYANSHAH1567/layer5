{"componentChunkName":"component---src-templates-learn-chapter-js-content-file-path-home-runner-work-layer-5-layer-5-content-learn-mastering-service-meshes-for-developers-advance-concepts-of-service-mesh-istio-service-security-capabilities-mdx","path":"/learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/service-security-capabilities.html.html","result":{"data":{"chapter":{"body":"\n\n\n<ChapterStyle>\n\n<h2 className=\"chapter-sub-heading\">Access Control</h2>\n\nYou will start by denying all traffic.\n\n```yaml\napiVersion: security.istio.io/v1beta1\nkind: AuthorizationPolicy\nmetadata:\n  name: deny-all\n  namespace: default\nspec: {}\n```\n\n<h3 className=\"chapter-sub-heading\">\n  And then begin poking holes in your service mesh \"firewall\".\n</h3>\n\n```yaml\n---\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"AuthorizationPolicy\"\nmetadata:\n  name: \"allow-get\"\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: httpbin\n  rules:\n    - to:\n        - operation:\n            methods: [\"GET\"]\n```\n\n<h3 className=\"chapter-sub-heading\">\n  Create AuthorizationPolicy for each BookInfo service.\n</h3>\n\n```yaml\n---\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"AuthorizationPolicy\"\nmetadata:\n  name: \"view-productpage\"\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: productpage\n  rules:\n    - to:\n        - operation:\n            methods: [\"GET\", \"POST\"] # try login with just GET (fails)\n---\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"AuthorizationPolicy\"\nmetadata:\n  name: \"view-details\"\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: details\n  rules:\n    - from:\n        - source:\n            principals: [\"cluster.local/ns/default/sa/bookinfo-productpage\"]\n      to:\n        - operation:\n            methods: [\"GET\", \"POST\"]\n---\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"AuthorizationPolicy\"\nmetadata:\n  name: \"view-reviews\"\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: reviews\n  rules:\n    - from:\n        - source:\n            principals: [\"cluster.local/ns/default/sa/bookinfo-productpage\"]\n      to:\n        - operation:\n            methods: [\"GET\", \"POST\"]\n---\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"AuthorizationPolicy\"\nmetadata:\n  name: \"view-ratings\"\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: ratings\n  rules:\n    - from:\n        - source:\n            principals: [\"cluster.local/ns/default/sa/bookinfo-reviews\"]\n      to:\n        - operation:\n            methods: [\"GET\", \"POST\"]\n```\n\n<h3 className=\"chapter-sub-heading\">Allow per user access</h3>\n\n```yaml\n---\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"AuthorizationPolicy\"\nmetadata:\n  name: \"view-reviews\"\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: reviews\n  rules:\n    - from:\n        - source:\n            principals: [\"cluster.local/ns/default/sa/bookinfo-productpage\"]\n      to:\n        - operation:\n            methods: [\"GET\"]\n      when:\n        - key: request.headers[end-user]\n          values: [\"naruto\"]\n```\n\n<h3 className=\"chapter-sub-heading\">\n  Reset BookInfo Subsets (reset destination rules)\n</h3>\n\n```yaml\napiVersion: networking.istio.io/v1alpha3\nkind: DestinationRule\nmetadata:\n  name: productpage\nspec:\n  host: productpage\n  subsets:\n    - name: v1\n      labels:\n        version: v1\n---\napiVersion: networking.istio.io/v1alpha3\nkind: DestinationRule\nmetadata:\n  name: reviews\nspec:\n  host: reviews\n  subsets:\n    - name: v1\n      labels:\n        version: v1\n    - name: v2\n      labels:\n        version: v2\n    - name: v3\n      labels:\n        version: v3\n---\napiVersion: networking.istio.io/v1alpha3\nkind: DestinationRule\nmetadata:\n  name: ratings\nspec:\n  host: ratings\n  subsets:\n    - name: v1\n      labels:\n        version: v1\n    - name: v2\n      labels:\n        version: v2\n    - name: v2-mysql\n      labels:\n        version: v2-mysql\n    - name: v2-mysql-vm\n      labels:\n        version: v2-mysql-vm\n---\napiVersion: networking.istio.io/v1alpha3\nkind: DestinationRule\nmetadata:\n  name: details\nspec:\n  host: details\n  subsets:\n    - name: v1\n      labels:\n        version: v1\n    - name: v2\n      labels:\n        version: v2\n---\n\n```\n\n<h2 className=\"chapter-sub-heading\">Identity Verification</h2>\n\nNote: this lab uses the sample application HTTPbin.\n\nUsing Meshery, deploy the HTTPbin sample application.\n\n<h3 className=\"chapter-sub-heading\">Add Claims</h3>\n\n```yaml\napiVersion: security.istio.io/v1beta1\nkind: AuthorizationPolicy\nmetadata:\n  name: require-jwt\n  namespace: foo\nspec:\n  selector:\n    matchLabels:\n      app: httpbin\n  action: ALLOW\n  rules:\n    - from:\n        - source:\n            requestPrincipals:\n              [\"testing@secure.istio.io/testing@secure.istio.io\"]\n      when:\n        - key: request.auth.claims[groups]\n          values: [\"group1\"]\n```\n\n<h3 className=\"chapter-sub-heading\">Def</h3>\n\n```yaml\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"RequestAuthentication\"\nmetadata:\n  name: \"jwt\"\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: httpbin\n  jwtRules:\n    - issuer: \"testing@secure.istio.io\"\n      jwksUri: \"https://raw.githubusercontent.com/istio/istio/release-1.7/security/tools/jwt/samples/jwks.json\"\n```\n\n<h2 className=\"chapter-sub-heading\">Mutual TLS</h2>\n\nUsing Meshery, you can change mTLS enforcement for a namespace.\n\nTo configure mTLS on more selective level, you can change and apply this configuration:\n\n```yaml\napiVersion: \"security.istio.io/v1beta1\"\nkind: \"PeerAuthentication\"\nmetadata:\n  name: \"default\"\n  namespace: \"istio-system\"\nspec:\n  # selector:\n  #   matchLabels:\n  #     app: httpbin\n  mtls:\n    mode: STRICT #ISTIO_MUTUAL,DISABLE\n  # portLevelMtls:\n  #   80:\n  #     mode: DISABLE\n```\n\n</ChapterStyle>\n","frontmatter":{"chapterTitle":"Service security capabilities","description":"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads."},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/service-security-capabilities","course":"advance-concepts-of-service-mesh","learnpath":"mastering-service-meshes-for-developers","chapter":"service-security-capabilities"}},"course":{"nodes":[{"frontmatter":{"courseTitle":"Advance Concepts of Service Meshes - Hands On","meshesYouLearn":[{"imagepath":{"childImageSharp":null,"extension":"svg","publicURL":"/static/731763d720780a49c2ffdfede8c28f4b/istio.svg"},"name":"Istio"},{"imagepath":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/webp;base64,UklGRl4CAABXRUJQVlA4WAoAAAAQAAAAEwAAEgAAQUxQSCsBAAABkK1t27FFd7Zt2y3WBti2bdvWmrHU0Q7YNbbtybZdz+D7/m2IiAkAY8hqnoBA3moIOFSBTPv19+/X7TJQYSm67VOG5X16pafcd1sEQNydhzdp5yCXnytw+exwJ4mXx118lV7aQLbj+psDROvOlwNsX9Iq9cze9CrB+iEN6EBvmG5ne4jeXf3aOcjm5wpePqsWhdOPq3dER/kC8h/oqx3E6s8X/bkE8g+J4mF+j0YfU7829EfonjniiWKw8dMFos/ptEoELj83EPPfbhq8Fi6ami4WvJC2y8EveqQFwyc//4timb27dlohXDz7XyRbsUTzxfwkyxOmB5owmiCmp9wiDLcnZcJoYRDhBlAfjdmmZzTnWTyL6Hqwz+7S1CTtzYJjz8eeXFyej72YAABWUDggDAEAANAGAJ0BKhQAEwA+0VykTqglIyIoCqkAGglsALsyhHtYgrcJsK8xLFfoAdLcXseXeC9VGgsgkUpjlH7xR/xXEADeLYf7CYczoIv9t/vBQKOfOllI+unz6A0lUpkyuYCaKrQ3V/cH/zwEMeMfwM3TEUaJUejIEnllgZV0KT+dRXgVwdljiM/5bOUho/K6UAbp3tBPzBB385WEFco7bcPG7AiNcgse0VFkQn/VypGu+AnTdSJIx1S2ryZdD/2XLOJ/2cfL0Hca9wb71w7I4H9Yu5BrsoDN2sW9vnwGPwP0y+vhwJpyyj8G2UOOH3E7diegyWWXc0Z6zTp5+P+Tfv1AmHIlVCYdE2okyAD9gAA="},"images":{"fallback":{"src":"/static/ca53815f6e4054379084f39f253f9a9d/2bba5/linkerd.webp","srcSet":"/static/ca53815f6e4054379084f39f253f9a9d/02e18/linkerd.webp 13w,\n/static/ca53815f6e4054379084f39f253f9a9d/04db5/linkerd.webp 25w,\n/static/ca53815f6e4054379084f39f253f9a9d/2bba5/linkerd.webp 50w,\n/static/ca53815f6e4054379084f39f253f9a9d/2d116/linkerd.webp 100w","sizes":"(min-width: 50px) 50px, 100vw"},"sources":[]},"width":50,"height":47}},"extension":"webp","publicURL":"/static/ca53815f6e4054379084f39f253f9a9d/linkerd.webp"},"name":"Linkerd"}]},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh"}}]},"TOC":{"nodes":[{"frontmatter":{"order":8,"chapterTitle":"Conclusion"},"fields":{"section":"istio","chapter":"conclusion"}},{"frontmatter":{"order":2,"chapterTitle":"Deploy a sample application"},"fields":{"section":"istio","chapter":"deploy-an-application"}},{"frontmatter":{"order":3,"chapterTitle":"Exposing services through Istio Ingress Gateway"},"fields":{"section":"istio","chapter":"expose-services"}},{"frontmatter":{"order":1,"chapterTitle":"Getting Started"},"fields":{"section":"istio","chapter":"getting-started"}},{"frontmatter":{"order":4,"chapterTitle":"Observability"},"fields":{"section":"istio","chapter":"observability"}},{"frontmatter":{"order":6,"chapterTitle":"Service security capabilities"},"fields":{"section":"istio","chapter":"service-security-capabilities"}},{"frontmatter":{"order":5,"chapterTitle":"Traffic management"},"fields":{"section":"istio","chapter":"traffic-management"}},{"frontmatter":{"order":7,"chapterTitle":"WebAssembly and intelligent data planes"},"fields":{"section":"istio","chapter":"webassembly-and-intelligent-data-planes"}}]},"serviceMeshesList":{"nodes":[{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}}]}},"pageContext":{"learnpath":"mastering-service-meshes-for-developers","slug":"learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/service-security-capabilities","course":"advance-concepts-of-service-mesh","section":"istio","chapter":"service-security-capabilities","pageType":"chapter","frontmatter":{"docType":"Chapter","chapterTitle":"Service security capabilities","description":"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads.","videos":4,"lectures":12,"order":6}}},"staticQueryHashes":["1376321266","1485533831","2848499768","4047814605","961506260"],"matchPath":"/learn/learning-paths/mastering-service-meshes-for-developers/advance-concepts-of-service-mesh/istio/service-security-capabilities.html"}