{"componentChunkName":"component---src-templates-learn-chapter-js-content-file-path-home-runner-work-layer-5-layer-5-content-learn-mastering-service-meshes-for-developers-introduction-to-service-meshes-istio-deploy-an-application-mdx","path":"/learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/istio/deploy-an-application.html.html","result":{"data":{"chapter":{"body":"\n\nimport BookInfoOffMesh from \"../../../../src/assets/images/learn-layer5/istio/bookinfo-off-mesh.webp\";\nimport BookInfoOnMesh from \"../../../../src/assets/images/learn-layer5/istio/bookinfo-on-mesh.webp\";\n\n<ChapterStyle>\n\nTo play with Istio and demonstrate some of it's capabilities, you will deploy the example BookInfo application, which is included the Istio package.\n\n<h2 className=\"chapter-sub-heading\">What is the Bookinfo Application </h2>\n<br />\nThis application is a polyglot composition of microservices are written in\ndifferent languages and sample BookInfo application displays information about a\nbook, similar to a single catalog entry of an online book store. Displayed on\nthe page is a description of the book, book details (ISBN, number of pages, and\nso on), and a few book reviews.\n\nThe end-to-end architecture of the application is shown in the figure.\n\n<br />\n<a href={BookInfoOffMesh}>\n  <img src={BookInfoOffMesh} width=\"100%\" align=\"center\" />\n</a>\n\n_Figure: BookInfo deployed off the mesh_\n\n<br />\nItâ€™s worth noting that these services have no dependencies on Istio, but make an\ninteresting service mesh example, particularly because of the multitude of services,\nlanguages and versions for the reviews service.\n\nAs shown in the figure below, proxies are sidecarred to each of the application containers.\n\n<br />\n<a href={BookInfoOnMesh}>\n  <img src={BookInfoOnMesh} width=\"100%\" align=\"center\" />\n</a>\n\n_Figure: BookInfo deployed on the mesh_\n\n<br />\nSidecars proxy can be either manually or automatically injected into the pods. Automatic\nsidecar injection requires that your Kubernetes api-server supports `admissionregistration.k8s.io/v1`\nor `admissionregistration.k8s.io/v1beta1` or `admissionregistration.k8s.io/v1beta2`\nAPIs. Verify whether your Kubernetes deployment supports these APIs by executing:\n\n```sh\nkubectl api-versions | grep admissionregistration\n```\n\nIf your environment **does NOT** supports either of these two APIs, then you may use [manual sidecar injection](#manual-sidecar-inj) to deploy the sample app.\n\nAs part of Istio deployment in [Previous chapter](./getting-started), you have deployed the sidecar injector.\n\n<br />\n<h2 className=\"chapter-sub-heading\">\n  <a name=\"auto\"></a> Deploying Sample App with Automatic sidecar injection\n</h2>\n\n<br />\nIstio, deployed as part of this workshop, will also deploy the sidecar injector.\nLet us now verify sidecar injector deployment.\n\n```sh\nkubectl -n istio-system get configmaps istio-sidecar-injector\n```\n\nOutput:\n\n```sh\nNAME                     DATA   AGE\nistio-sidecar-injector   2      9h\n```\n\nNamespaceSelector decides whether to run the webhook on an object based on whether the namespace for that object matches the [selector](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors).\n\n```sh\nkubectl get namespace -L istio-injection\n```\n\nOutput:\n\n```sh\nNAME           STATUS    AGE       ISTIO-INJECTION\ndefault        Active    1h        enabled\nistio-system   Active    1h        disabled\nkube-public    Active    1h\nkube-system    Active    1h\n```\n\nUsing Meshery, navigate to the Istio management page.\n\n1. Enter `default` in the `Namespace` field.\n1. Click the (+) icon on the `Sample Application` card and select `BookInfo Application` from the list.\n\nThis will do 3 things:\n\n1. Label `default` namespace for sidecar injection.\n1. Deploys all the BookInfo services in the `default` namespace.\n1. Deploys the virtual service and gateway needed to expose the BookInfo's productpage application in the `default` namespace.\n\n<h3 className=\"chapter-sub-heading\">\n  <a name=\"verify\"></a> Verify Bookinfo deployment{\" \"}\n</h3>\n\n1. Verify that the deployments are all in a state of AVAILABLE before continuing.\n\n```sh\nwatch kubectl get deployment\n```\n\n2. Choose a service, for instance `productpage`, and view it's container configuration:\n\n```sh\nkubectl get po\n\nkubectl describe pod productpage-v1-.....\n```\n\n3. Examine details of the services:\n\n```sh\nkubectl describe svc productpage\n ```\n\nNext, you will expose the BookInfo application to be accessed external from the cluster.\n\n<br />\n<h3>Alternative: Manual installation </h3>\nFollow this if the above steps did not work for you\n<br />\n<br />\n\n<h4 className=\"chapter-alt-heading\"> Label namespace for injection</h4>\n\nLabel the default namespace with istio-injection=enabled\n\n```sh\nkubectl label namespace default istio-injection=enabled\n```\n\n```sh\nkubectl get namespace -L istio-injection\n```\n\nOutput:\n\n```sh\nNAME           STATUS    AGE       ISTIO-INJECTION\ndefault        Active    1h        enabled\nistio-system   Active    1h        disabled\nkube-public    Active    1h\nkube-system    Active    1h\n```\n\n<h4 className=\"chapter-alt-heading\"> Deploy BookInfo</h4>\n<br />\n\nApplying this yaml file included in the Istio package you collected in [Getting Started](./getting-started) will deploy the BookInfo app in you cluster.\n\n```sh\nkubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml\n```\n\n<h4 className=\"chapter-alt-heading\">\n  Deploy Gateway and Virtual Service for BookInfo app\n</h4>\n\n```sh\nkubectl apply -f samples/bookinfo/networking/bookinfo-gateway.yaml\n```\n\n<hr />\n<br />\n\n<h3>\n  <a name=\"manual-sidecar-inj\" />\n  Manual Sidecar Injection\n</h3>\n\n<p>Use this only when Automatic Sidecar injection doesn't work</p>\n\nTo do a manual sidecar injection we will be using `istioctl` command:\n\n```sh\ncurl https://raw.githubusercontent.com/istio/istio/master/samples/bookinfo/platform/kube/bookinfo.yaml | istioctl kube-inject -f - > newBookInfo.yaml\n```\n\nObserving the new yaml file reveals that additional container Istio Proxy has been added to the Pods with necessary configurations:\n\n```\n        image: docker.io/istio/proxyv2:1.3.0\n        imagePullPolicy: IfNotPresent\n        name: istio-proxy\n```\n\nWe need to now deploy the new yaml using `kubectl`\n\n```sh\nkubectl apply -f newBookInfo.yaml\n```\n\nTo do both in a single command:\n\n```sh\nkubectl apply -f <(curl https://raw.githubusercontent.com/istio/istio/master/samples/bookinfo/platform/kube/bookinfo.yaml | istioctl kube-inject -f -)\n```\n\nNow continue to [Verify Bookinfo deployment](#verify).\n\n</ChapterStyle>\n","frontmatter":{"chapterTitle":"Deploy a sample application","description":"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads."},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/istio/deploy-an-application","course":"introduction-to-service-meshes","learnpath":"mastering-service-meshes-for-developers","chapter":"deploy-an-application"}},"course":{"nodes":[{"frontmatter":{"courseTitle":"Introduction to Service Meshes - Hands On","meshesYouLearn":[{"imagepath":{"childImageSharp":null,"extension":"svg","publicURL":"/static/731763d720780a49c2ffdfede8c28f4b/istio.svg"},"name":"Istio"},{"imagepath":{"childImageSharp":null,"extension":"svg","publicURL":"/static/b4f4020971de42f6fb2497075a67f325/linkerd.svg"},"name":"Linkerd"}]},"fields":{"slug":"learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes"}}]},"TOC":{"nodes":[{"frontmatter":{"order":8,"chapterTitle":"Circuit Breaking"},"fields":{"section":"istio","chapter":"circuit-breaking"}},{"frontmatter":{"order":9,"chapterTitle":"Conclusion"},"fields":{"section":"istio","chapter":"conclusion"}},{"frontmatter":{"order":2,"chapterTitle":"Deploy a sample application"},"fields":{"section":"istio","chapter":"deploy-an-application"}},{"frontmatter":{"order":3,"chapterTitle":"Exposing services through Istio Ingress Gateway"},"fields":{"section":"istio","chapter":"expose-services"}},{"frontmatter":{"order":6,"chapterTitle":"Fault Injection"},"fields":{"section":"istio","chapter":"fault-injection"}},{"frontmatter":{"order":1,"chapterTitle":"Getting Started"},"fields":{"section":"istio","chapter":"getting-started"}},{"frontmatter":{"order":7,"chapterTitle":"Mutual TLS & Identity Verification"},"fields":{"section":"istio","chapter":"mutual-tls"}},{"frontmatter":{"order":4,"chapterTitle":"Observability"},"fields":{"section":"istio","chapter":"observability"}},{"frontmatter":{"order":5,"chapterTitle":"Request Routing and Canary Testing"},"fields":{"section":"istio","chapter":"routing-and-canary"}},{"frontmatter":{"order":9,"chapterTitle":"Conclusion"},"fields":{"section":"linkerd","chapter":"conclusion"}},{"frontmatter":{"order":4,"chapterTitle":"Linkerd Dashboard"},"fields":{"section":"linkerd","chapter":"dashboard"}},{"frontmatter":{"order":5,"chapterTitle":"Debugging (Optional)"},"fields":{"section":"linkerd","chapter":"debugging"}},{"frontmatter":{"order":2,"chapterTitle":"Deploy a sample application"},"fields":{"section":"linkerd","chapter":"deploy-an-application"}},{"frontmatter":{"order":3,"chapterTitle":"Exposing services through Linkerd Ingress"},"fields":{"section":"linkerd","chapter":"expose-services"}},{"frontmatter":{"order":8,"chapterTitle":"Fault Injection"},"fields":{"section":"linkerd","chapter":"fault-injection"}},{"frontmatter":{"order":1,"chapterTitle":"Getting Started"},"fields":{"section":"linkerd","chapter":"getting-started"}},{"frontmatter":{"order":6,"chapterTitle":"Observability"},"fields":{"section":"linkerd","chapter":"observability"}},{"frontmatter":{"order":7,"chapterTitle":"Traffic Splitting using SMI and Linkerd"},"fields":{"section":"linkerd","chapter":"traffic-splitting"}}]},"serviceMeshesList":{"nodes":[{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"istio"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}},{"fields":{"section":"linkerd"}}]}},"pageContext":{"learnpath":"mastering-service-meshes-for-developers","slug":"learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/istio/deploy-an-application","course":"introduction-to-service-meshes","section":"istio","chapter":"deploy-an-application","pageType":"chapter","frontmatter":{"docType":"Chapter","chapterTitle":"Deploy a sample application","description":"Meshery is the cloud native management plane which offers lifecycle, configuration, and performance management of service meshes and their workloads.","videos":4,"lectures":12,"order":2}}},"staticQueryHashes":["1376321266","1485533831","2848499768","4047814605","961506260"],"matchPath":"/learn/learning-paths/mastering-service-meshes-for-developers/introduction-to-service-meshes/istio/deploy-an-application.html"}